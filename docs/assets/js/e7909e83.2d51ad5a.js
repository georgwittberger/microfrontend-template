"use strict";(self.webpackChunkmicrofrontend_template_docs=self.webpackChunkmicrofrontend_template_docs||[]).push([[179],{9613:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>f});var o=n(9496);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=o.createContext({}),l=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=l(e.components);return o.createElement(c.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},u=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),m=l(n),u=r,f=m["".concat(c,".").concat(u)]||m[u]||d[u]||a;return n?o.createElement(f,i(i({ref:t},s),{},{components:n})):o.createElement(f,i({ref:t},s))}));function f(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=u;var p={};for(var c in t)hasOwnProperty.call(t,c)&&(p[c]=t[c]);p.originalType=e,p[m]="string"==typeof e?e:r,i[1]=p;for(var l=2;l<a;l++)i[l]=n[l];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}u.displayName="MDXCreateElement"},4444:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>i,default:()=>d,frontMatter:()=>a,metadata:()=>p,toc:()=>l});var o=n(7366),r=(n(9496),n(9613));const a={description:"Host application implementation using ES modules",sidebar_position:3},i="Host Application using ES Modules",p={unversionedId:"concepts/host-app-esmodule",id:"concepts/host-app-esmodule",title:"Host Application using ES Modules",description:"Host application implementation using ES modules",source:"@site/docs/concepts/host-app-esmodule.md",sourceDirName:"concepts",slug:"/concepts/host-app-esmodule",permalink:"/microfrontend-template/concepts/host-app-esmodule",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{description:"Host application implementation using ES modules",sidebar_position:3},sidebar:"sidebar",previous:{title:"Microfrontend using React",permalink:"/microfrontend-template/concepts/microfrontend-react"},next:{title:"Host Application using React",permalink:"/microfrontend-template/concepts/host-app-react"}},c={},l=[{value:"Implementation",id:"implementation",level:2},{value:"Example",id:"example",level:2}],s={toc:l},m="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(m,(0,o.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"host-application-using-es-modules"},"Host Application using ES Modules"),(0,r.kt)("h2",{id:"implementation"},"Implementation"),(0,r.kt)("p",null,"The host application must render a container element in the HTML document and import the microfrontend JavaScript module using ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/import"},"dynamic import"),". It passes a remote URL to the ",(0,r.kt)("inlineCode",{parentName:"p"},"import()")," function to fetch the module from the microfrontend server."),(0,r.kt)("p",null,"As soon as the JavaScript module has been loaded the host application calls the exported mount function and passes a reference to the container element."),(0,r.kt)("p",null,"If loading the JavaScript module fails the host application may render some error message."),(0,r.kt)("p",null,"While the user stays on the same page the host application may call the ",(0,r.kt)("inlineCode",{parentName:"p"},"update")," function of the microfrontend (if returned) to send new data from the host to the microfrontend."),(0,r.kt)("p",null,"When the user navigates away from the page the host application may call the ",(0,r.kt)("inlineCode",{parentName:"p"},"unmount")," function of the microfrontend (if returned) to trigger its cleanup. This is important if the host is a single-page application where the entire page is not reloaded on navigation."),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If your host application uses Content Security Policy make sure to allow the microfrontend remote URL as ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src"},"script-src"),".")),(0,r.kt)("h2",{id:"example"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!--\n  Container element being the wrapper for the microfrontend.\n--\x3e\n<div id="mfe-root"></div>\n\n\x3c!--\n  Script to import and mount the microfrontend.\n--\x3e\n<script type="module">\n  /**\n   * 1. Render some loading indicator.\n   */\n\n  /**\n   * 2. Import the microfrontend JavaScript module from its remote URL.\n   */\n  let mfe;\n  import("https://my-service.my-company.com/mfe-module.js")\n    .then(({ default: mount }) => {\n      /**\n       * 3a. Call the exported mount function and pass it the container element.\n       */\n      mfe = mount(document.getElementById("mfe-root"), { myProp: "My Value" });\n    })\n    .catch((error) => {\n      console.error("Error loading microfrontend module", error);\n      /**\n       * 3b. Render some error message.\n       */\n    })\n    .finally(() => {\n      /**\n       * 4. Remove the loading indicator.\n       */\n    });\n\n  /**\n   * When data changes in the host application maybe update the microfrontend.\n   */\n  mfe?.update?.({ myProp: "New Value" });\n\n  /**\n   * When leaving the page remove the microfrontend.\n   */\n  mfe?.unmount?.();\n<\/script>\n')),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Do not put the literal remote URL of the microfrontend JavaScript module in your code. Instead externalize the value and pass a variable to the ",(0,r.kt)("inlineCode",{parentName:"p"},"import()")," function to allow configuration of the URL without having to change code.")))}d.isMDXComponent=!0}}]);